## Fliplet Event – Playwright Test Suite

End-to-end, journeys, RBAC, performance, and accessibility tests for the Fliplet Event app using Playwright.

### Key Features
- Global setup project generates role-based `storageState` for fast, isolated tests
- Global teardown cleans auth artifacts for clean runs
- Projects split by feature area and role for parallel CI execution
- Role-first, user-centric selectors (`getByRole`, `getByLabel`, `getByTestId`)
- Trace-on-retry, HTML reporting, and UI mode for local debugging

### Prerequisites
- Node.js 18+
- Git and a modern shell
- Installed browsers: `npm run test:install`

### Quick Start
```bash
npm ci
cp env.example .env   # set BASE_URL and user credentials
npm run test:install  # installs Playwright browsers
npm test              # run entire suite
```

### Environment Variables (.env)
The suite reads configuration from `.env` via `test-data/app.data.ts`.

Required keys:
```
BASE_URL=

ADMIN_EMAIL=
ADMIN_PASSWORD=
ATTENDEE_EMAIL=
ATTENDEE_PASSWORD=
EXHIBITOR_EMAIL=
EXHIBITOR_PASSWORD=
SPEAKER_EMAIL=
SPEAKER_PASSWORD=

INVALID_EMAIL=
INVALID_PASSWORD=
```

### NPM Scripts
```bash
# Full suite
npm test

# Subsets
npm run test:user
npm run test:admin
npm run test:features
npm run test:journeys
npm run test:e2e
npm run test:regression
npm run test:smoke

# Parallel/CI-friendly
npm run test:parallel
npm run test:ci

# Debugging & tooling
npm run test:headed
npm run test:debug
npm run test:ui
npm run test:report
npm run test:trace
```

### Playwright Configuration Highlights
- `playwright.config.ts`
  - `fullyParallel: true`, `retries` enabled on CI, `reporter: 'html'`
  - `use.baseURL` from `.env` and `trace: 'on-first-retry'`
  - `projects`
    - `setup`: runs `global-setup/auth.setup.ts` to persist `storage-state/*.json`
    - Feature projects (Admin/Attendee/Exhibitor/Speaker/Auth) use role storage states and match relevant spec directories
  - `globalTeardown`: `global-setup/global-teardown.ts` removes `storage-state/*.json`

Run just the setup project (useful while developing login flows):
```bash
npx playwright test --project=setup
```

Run only Admin specs:
```bash
npx playwright test --project="Admin Tests"
```

Manually trigger global teardown (skip all tests but execute teardown):
```bash
npx playwright test --grep-invert ".*"
```

### Repository Structure
```
global-setup/            # auth.setup.ts creates storage state; global-teardown.ts cleans artifacts
page-objects/            # Page Object Model (one file per screen/feature)
tests/
  auth/                  # Login, onboarding, registration, password reset
  admin/                 # Admin features (content, attendance, agenda, etc.)
  user/                  # Attendee features (agenda, meetings, networking, etc.)
  journeys/              # Cross-page user journeys by role
  rbac/                  # Role-based access control
  accessibility/         # A11y checks and screen reader flows
  integration/           # API/data synchronization/end-to-end integration
  performance/           # Basic performance checks
utils/                   # Utilities (e.g., page-url-resolver)
test-data/               # Environment-configured test data
storage-state/           # Auth contexts (generated by setup)
playwright-report/       # HTML reports (generated)
test-results/            # Raw artifacts (generated)
```

### Page Objects & Selectors
- Prefer resilient, user-facing locators: `page.getByRole`, `page.getByLabel`, `page.getByText`, `page.getByTestId`
- Avoid brittle CSS/XPath; add `data-testid` where necessary for stability
- Keep page objects lean: expose clear, task-oriented methods that mirror user actions

### Setup and Teardown Flow
- Setup generates storage states for roles (Admin, Attendee, Exhibitor, Speaker)
- Projects that depend on setup reference the appropriate `storageState`
- Global teardown removes storage state files to ensure independence between runs

### Running With Traces, Headed, UI
```bash
npx playwright test --headed
npx playwright test --debug
npx playwright test --trace=on           # always trace
npx playwright show-report               # open HTML report
npx playwright show-trace trace.zip      # open saved trace
```

### CI/CD Notes
- Entirely CLI-driven; suitable for any CI runner
- Recommended defaults:
  - `npx playwright install --with-deps`
  - `npm ci && npm run test:ci`
  - Upload `playwright-report/` as an artifact

### Conventions & Principles
- Separation of Concerns: tests vs. page objects vs. data
- DRY: extract reusable flows into helpers/page objects
- Test Independence & Atomicity: no hidden state; do not depend on prior test
- AAA: Arrange inputs, Act with one user action, Assert results
- Explicit waits via Playwright’s auto-wait and web-first assertions; no fixed sleeps
- Stable selectors first (`getByRole`, `getByTestId`), avoid fragile selectors
- KISS: keep tests simple, readable, and maintainable

### Troubleshooting
- "No tests found" when running setup or teardown-only commands is expected if you purposely filter tests
- Ensure `.env` is populated; missing `BASE_URL` or credentials cause navigation/login failures
- If report doesn’t open: run `npm run test:report`

### License
ISC


